<%- include header %>
<script type="text/javascript">
	window.onload = function () {

		var dps = []; // dataPoints

		var chart = new CanvasJS.Chart("chartContainer",{
			title :{
				text: "脉搏波信号"
			},
			data: [{
				type: "line",
				dataPoints: dps
			}]
		});

		var xVal = 0;
		var yVal = 100;
		var updateInterval = 100;
		var dataLength = 500; // number of dataPoints visible at any point

		var updateChart = function (count) {
			count = count || 1;
			// count is number of times loop runs to generate random dataPoints.

			for (var j = 0; j < count; j++) {
				yVal = yVal +  Math.round(5 + Math.random() *(-5-5));
				dps.push({
					x: xVal,
					y: yVal
				});
				xVal++;
			};
			if (dps.length > dataLength)
			{
				dps.shift();
			}

			chart.render();

		};

		// generates first set of dataPoints
		updateChart(dataLength);

		// update chart after specified time.
		setInterval(function(){updateChart()}, updateInterval);

	}
</script>
<% if (user) { %>
<%- include sider %>
<% } else { %>
<script>location.href = "/login"</script>
<% } %>
<div class="wid main-page">
	<h4>中医体质辨识系统脉搏波采集</h4>
	<div id="chartContainer"></div>
	<form>
		<label for="openPort">开启串口</label>
		<input type="text" name="openPort" id="openPort">
		<label for="baudrate">波特率</label>
		<input type="text" id="baudrate" name="baudrate" readonly>
		<button type="button" class="btn btn-default">开启设备</button>
		<button type="button" class="btn btn-primary">停止设备</button>
		<button type="button" class="btn btn-default">开始采样</button>
		<button type="button" class="btn btn-primary">停止采样</button>
		<div>
			<button class="btn btn-primary btn-load" type="submit"><span class="glyphicon glyphicon-upload"></span>上传</button>
		</div>
	</form>
</div>
<%- include footer %>